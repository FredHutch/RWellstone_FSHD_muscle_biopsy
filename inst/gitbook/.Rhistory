#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_wrap(~class + attribute, nrow=6) +
geom_vline(data=mu, aes(xintercept=mean),
linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
mu
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_wrap(~class + attribute, nrow=6) +
geom_vline(data=mu, aes(xintercept=mean, color=attribute),
linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_wrap(.~ class + attribute, nrow=6) +
geom_vline(data=mu, aes(xintercept=mean),
linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_wrap(.~ class + attribute, nrow=6) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
gg <- gg + geom_vline(data=mu, aes(xintercept=mean),
linetype="dashed", size=2)
gg
mu
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class + attribute ~., nrow=6) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(.~ class + attribute, nrow=6) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(.~ class + attribute) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
gg <- gg + geom_vline(data=mu, aes(xintercept=mean),
linetype="dashed", size=2)
gg
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(.~ class + attribute, ncol=2) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
?facet_grid
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(.~ class + attribute, rows=6) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(.~ class + attribute, rows=6, cols=2) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class + attribute, rows=6, cols=2) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute, rows=6, cols=2) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute, rows=vars(class), cols=vars(attribute)) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute, rows=vars(class) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
gg <- gg + geom_vline(data=mu, aes(xintercept=mean),
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute, rows=vars(class)) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
?vars
vars(tmp$class)
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute, rows=vars(class), cols=vars(attribute)) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute, rows=vars(class), cols=vars(attribute), scales="fixed") +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute, rows=vars(class), cols=vars(attribute), space="fixed") +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
gg <- gg + geom_vline(data=mu, aes(xintercept=mean),
linetype="dashed", size=2)
gg
mu
?geom_vline
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
gg <- gg + geom_vline(aes(xintercept=mean), mu,
linetype="dashed", size=2)
gg
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
gg <- gg + geom_vline(aes(xintercept=mean), data=mu,
linetype="dashed", size=2)
gg
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
gg <- gg + geom_vline(aes(xintercept=mean), data=mu, color=attribute,
linetype="dashed", size=2)
mu
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
gg <- gg + geom_vline(aes(xintercept=mean, color=attribute), data=mu,
linetype="dashed", size=2)
gg
mu
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog)) %>%
mutate(attribute=factor(attribute))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute) +
#geom_vline(data=mu, aes(xintercept=mean),
#          linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
gg <- gg + geom_vline(aes(xintercept=mean, color=attribute), data=mu,
linetype="dashed", size=2)
gg
mu
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog)) %>%
mutate(attribute=factor(attribute))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute) +
geom_vline(aes(xintercept=mean, color=attribute), data=mu,
linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
gg
mu
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog)) %>%
mutate(attribute=factor(attribute))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute) +
geom_vline(aes(xintercept=mean, color=attribute), data=mu[1:2,],
linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
gg
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog)) %>%
mutate(attribute=factor(attribute))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute) +
geom_vline(aes(xintercept=mean, fill=attribute), data=mu[1:2,],
linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
gg
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog)) %>%
mutate(attribute=factor(attribute))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute) +
geom_vline(aes(xintercept=mean, color=attribute), data=mu[1:2,],
linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
gg
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog)) %>%
mutate(attribute=factor(attribute))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute) +
geom_vline(aes(xintercept=mean, color=attribute), data=mu,
linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
gg
mu
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog)) %>%
mutate(attribute=factor(attribute))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute) +
geom_vline(aes(xintercept=mean), data=mu,
linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="bottom")
gg
mu
tmp <- df_rlog %>% gather(key=class, value=rlog, -attribute) %>%
mutate(class=factor(class, levels=c("Control", "Mild", "Moderate",
"IG-High", "High", "Muscle-Low")))
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog)) %>%
mutate(attribute=factor(attribute))
gg <- ggplot(tmp, aes(x=rlog, fill=attribute)) +
geom_density() +
theme_bw() +
labs(title="Density of PAX7 target genes per class") +
facet_grid(class ~ attribute) +
geom_vline(aes(xintercept=mean), data=mu,
linetype="dashed", size=2) +
scale_color_brewer(palette="Dark2") +
theme(legend.position="none")
gg
load(file.path(pkg_dir, "public_data", "sanitized.rlg.rda"))
sanitized.rlg$new_cluster_name <- sanitized.dds$new_cluster_name
df_rlog <- lapply(levels(sanitized.rlg$new_cluster_name), function(class) {
sub <- sanitized.rlg[pax7_targets$gencode_id, sanitized.rlg$new_cluster_name == class]
rowMeans(assay(sub))
})
names(df_rlog) <- levels(sanitized.rlg$new_cluster_name)
df_rlog <- as.data.frame(do.call(cbind, df_rlog)) %>%
add_column(attribute=pax7_targets$attribute)
mu <- tmp %>% group_by(class, attribute) %>%
summarise(mean=mean(rlog), median=median(rlog)) %>%
mutate(attribute=factor(attribute))
mu
mk <- get(load(file.path(pkg_dir, "data", "FSHD_markers.rda")))
mk_rlog <- lapply(levels(sanitized.rlg$RNA_cluster_5), function(class) {
sub <- sanitized.rlg[mk$gene_id, sanitized.rlg$RNA_cluster_5 == class]
rowMeans(assay(sub))
})
names(mk_rlog) <- levels(sanitized.rlg$RNA_cluster_5)
mk_rlog <- as.data.frame(do.call(cbind, mk_rlog))
colnames(mk_rlog) <- c("Control", "Mild", "Moderate", "IG-High", "High", "Muscle-Low")
mk_rlog
mk
